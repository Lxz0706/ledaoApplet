(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["common/journalInfo/journal"],{162:function(e,t,o){"use strict";(function(e){o(5);n(o(4));var t=n(o(163));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=o,e(t.default)}).call(this,o(1)["createPage"])},163:function(e,t,o){"use strict";o.r(t);var n=o(164),i=o(166);for(var r in i)"default"!==r&&function(e){o.d(t,e,(function(){return i[e]}))}(r);o(168),o(170);var s,a=o(11),u=Object(a["default"])(i["default"],n["render"],n["staticRenderFns"],!1,null,"63a98d17",null,!1,n["components"],s);u.options.__file="common/journalInfo/journal.vue",t["default"]=u.exports},164:function(e,t,o){"use strict";o.r(t);var n=o(165);o.d(t,"render",(function(){return n["render"]})),o.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),o.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),o.d(t,"components",(function(){return n["components"]}))},165:function(e,t,o){"use strict";var n;o.r(t),o.d(t,"render",(function(){return i})),o.d(t,"staticRenderFns",(function(){return s})),o.d(t,"recyclableRender",(function(){return r})),o.d(t,"components",(function(){return n}));try{n={uniForms:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(o.bind(null,278))},uniFormsItem:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item")]).then(o.bind(null,287))},uniEasyinput:function(){return o.e("uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput").then(o.bind(null,294))},uniIcons:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(o.bind(null,329))},uniDateformat:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-dateformat/components/uni-dateformat/uni-dateformat")]).then(o.bind(null,396))},uniFab:function(){return o.e("uni_modules/uni-fab/components/uni-fab/uni-fab").then(o.bind(null,402))},uniPopup:function(){return o.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(o.bind(null,322))},uniDrawer:function(){return o.e("uni_modules/uni-drawer/components/uni-drawer/uni-drawer").then(o.bind(null,347))},uniRow:function(){return o.e("uni_modules/uni-row/components/uni-row/uni-row").then(o.bind(null,354))},uniCol:function(){return o.e("uni_modules/uni-row/components/uni-col/uni-col").then(o.bind(null,361))}}}catch(a){if(-1===a.message.indexOf("Cannot find module")||-1===a.message.indexOf(".vue"))throw a;console.error(a.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){!e.showAdd&&1!=e.isChat&&e.showProRight()})},r=!1,s=[];i._withStripped=!0},166:function(e,t,o){"use strict";o.r(t);var n=o(167),i=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,(function(){return n[e]}))}(r);t["default"]=i.a},167:function(e,t,o){"use strict";(function(e){function o(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={name:"journal",data:function(){return{formData:{workDetail:"",chatDetail:"",proId:"",projectName:"",userName:[],id:""},rules:{workDetail:{rules:[{required:!0,errorMessage:"必填"}]},projectName:{rules:[{required:!0,errorMessage:"必填"}]}},userList:[],chooseUserVals:"",isChat:0,isManager:!1,chooseProVal:{},projectList:[],stepOption:[],fileList:[],isShowTitle:!1,dateTimeDis:!1,chatDetailA:[],setFocus:!1,indexV:"",Reply:"",loginName:"",detailsList:[],journalId:"",journalCommentId:"",projectNameSearch:"",showChatAll:!1,showAdd:!1,proIds:"",createBy:"",replyName:"",replyBy:"",holder:""}},watch:{holder:function(){this.holder="回复  "+this.replyName}},onLoad:function(e){if(e.item){var t=JSON.parse(e.item);this.formData=t,this.proIds=t.proId}this.isChat=e.isChat,this.createBy=e.createBy},mounted:function(){this.loginName=e.getStorageSync("userName"),this.init()},methods:{init:function(){this.timeoutFunc(),1==this.isChat&&this.getChatDetailList()},getChatDetailList:function(){var t=this;this.$request("/system/comment/listCommentDtail","POST",{journalId:null==this.formData.id?"":this.formData.id,proId:this.proIds,commentTime:e.getStorageSync("datePeople")},{"content-type":"application/x-www-form-urlencoded",cookie:e.getStorageSync("setCookie")}).then((function(o){"login"==o||500==o.code&&o.msg.includes("Authentication")?(e.setStorageSync("loginSuccess",!1),setTimeout((function(){e.showToast({title:"登录已失效！",icon:"error",duration:3e3}),setTimeout((function(){e.switchTab({url:"/pages/home/index",success:function(){var e=getCurrentPages().pop();e&&e.onLoad()}})}),3e3)}),1e3)):(t.chatDetailA=o.data,t.formData.chatDetail="",t.chatDetailA.length>0&&(t.showChatAll=!0,t.formData.id=o.data[0].journalId))}))},jonClick:function(){var t=this;this.$request("/system/comment/add","POST",{parentId:this.journalCommentId,chatDetail:this.Reply,journalId:this.formData.id,commentTime:e.getStorageSync("datePeople"),temporaryName:this.createBy,replyBy:this.replyBy,replyName:this.replyName},{"content-type":"application/x-www-form-urlencoded",cookie:e.getStorageSync("setCookie")}).then((function(o){"login"==o||500==o.code&&o.msg.includes("Authentication")?(e.setStorageSync("loginSuccess",!1),setTimeout((function(){e.showToast({title:"登录已失效！",icon:"error",duration:3e3}),setTimeout((function(){e.switchTab({url:"/pages/home/index",success:function(){var e=getCurrentPages().pop();e&&e.onLoad()}})}),3e3)}),1e3)):0==o.code&&t.getChatDetailList()}))},timeoutFunc:function(){var e=new Date,t=e.getHours();this.dateTimeDis=!(t>=18&&t<24)},fabClick:function(){e.redirectTo({url:"./journalone"})},getProList:function(){var t=this;e.showLoading({title:"加载中...",mask:!0}),this.$request("/system/project/listProTh","POST",{projectName:this.projectNameSearch},{"content-type":"application/x-www-form-urlencoded",cookie:e.getStorageSync("setCookie")}).then((function(o){"login"==o||500==o.code&&o.msg.includes("Authentication")?(e.setStorageSync("loginSuccess",!1),setTimeout((function(){e.showToast({title:"登录已失效！",icon:"error",duration:3e3}),setTimeout((function(){e.switchTab({url:"/pages/home/index",success:function(){var e=getCurrentPages().pop();e&&e.onLoad()}})}),3e3)}),1e3)):(0==o.code&&(o.data.length>0?t.projectList=o.data:(t.projectList=[],t.isShowTitle=!0,e.showToast({icon:"error",position:"bottom",title:"没有更多了"}))),e.hideLoading())}))},submit:function(){var t=this;this.$refs.form.validate().then((function(o){t.$request("/system/journal/add","POST",n({},t.formData),{"content-type":"application/x-www-form-urlencoded",cookie:e.getStorageSync("setCookie")}).then((function(o){"login"==o||500==o.code&&o.msg.includes("Authentication")?setTimeout((function(){e.showToast({title:"登录已失效！",icon:"error",duration:3e3}),setTimeout((function(){e.switchTab({url:"/pages/home/index",success:function(){var e=getCurrentPages().pop();e&&e.onLoad()}})}),3e3)}),1e3):(0==o.code&&(t.showAdd=!0,setTimeout((function(){e.showToast({title:"提交成功",icon:"success",duration:3e3})}),500)),console.log(",tijiao",o))}))})).catch((function(e){console.log("err",e)}))},submitIsChat:function(){var t=this;""==this.formData.chatDetail||void 0==this.formData.chatDetail?e.showToast({title:"评论内容不能为空",duration:3e3,icon:"none"}):this.$refs.form.validate().then((function(o){t.$request("/system/comment/add","POST",{journalId:null==t.formData.id?"":t.formData.id,proId:t.proIds,workDetail:t.formData.chatDetail,remarks1:0,commentTime:e.getStorageSync("datePeople"),temporaryName:t.createBy},{"content-type":"application/x-www-form-urlencoded",cookie:e.getStorageSync("setCookie")}).then((function(o){"login"==o||500==o.code&&o.msg.includes("Authentication")?setTimeout((function(){e.showToast({title:"登录已失效！",icon:"error",duration:3e3}),setTimeout((function(){e.switchTab({url:"/pages/home/index",success:function(){var e=getCurrentPages().pop();e&&e.onLoad()}})}),3e3)}),1e3):(0==o.code&&(t.$refs.chatDetail.val="",t.getChatDetailList()),console.log("IsChat",o))}))})).catch((function(e){}))},huifuClick:function(e,t,o,n){this.$refs.popup.open("bottom"),this.setFocus=!0,this.indexV=e,this.journalCommentId=t,this.replyBy=o,this.replyName=n,this.holder="回复："+n},send:function(){""==this.Reply?e.showToast({title:"回复内容不能为空",duration:2e3,icon:"none"}):this.jonClick(),this.Reply="",this.$refs.popup.close()},showProRight:function(){this.getProList(),this.$refs.showProRight.open()},closeProDrawer:function(){this.$refs.showProRight.close()},inputFocus:function(){this.dateTimeDis&&0==this.isChat&&e.showToast({title:"非填写时段，请在 18:00-23:59 填写",icon:"none"})},choosePro:function(t){var o=this;o.$request("/system/journal/listByProId","POST",{proId:t.projectId},{"content-type":"application/x-www-form-urlencoded",cookie:e.getStorageSync("setCookie")}).then((function(n){"login"==n||500==n.code&&n.msg.includes("Authentication")?setTimeout((function(){e.showToast({title:"登录已失效！",icon:"error",duration:3e3}),setTimeout((function(){e.switchTab({url:"/pages/home/index",success:function(){var e=getCurrentPages().pop();e&&e.onLoad()}})}),3e3)}),1e3):n.rows.length>0?e.showModal({title:"该项目日志已存在，是否继续编辑？",success:function(e){e.confirm?(console.log("用户点击确定"),0==n.rows[0].proId?o.formData.projectName="无项目":o.formData.projectName=n.rows[0].projectName,o.formData.workDetail=n.rows[0].workDetail,o.formData.proId=n.rows[0].projectId,o.formData.id=n.rows[0].id,o.$refs.showProRight.close()):e.cancel}}):(o.formData.projectName=t.projectName,o.formData.proId=t.projectId,o.$refs.showProRight.close())}))},searchPro:function(){this.getProList()}}};t.default=r}).call(this,o(1)["default"])},168:function(e,t,o){"use strict";o.r(t);var n=o(169),i=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,(function(){return n[e]}))}(r);t["default"]=i.a},169:function(e,t,o){},170:function(e,t,o){"use strict";o.r(t);var n=o(171),i=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,(function(){return n[e]}))}(r);t["default"]=i.a},171:function(e,t,o){}},[[162,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/common/journalInfo/journal.js.map